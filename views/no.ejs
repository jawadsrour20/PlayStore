<!DOCTYPE html>
<html>
    
    <head>
      <meta charset="UTF-8">
      <title> Downloadable </title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"> -->
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- Font Awesome Icon Library -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

      <link rel="stylesheet" href="/CSS/movies.css" />


    </head>
    
    <body>
      <nav class="top-nav">
            <!-- search bar -->
            <div class="wrap">
              <div class="search">
                <input
                  type="text"
                  class="searchTerm"
                  placeholder="What are you looking for?"
                />
                <button type="submit" class="searchButton">
                  <i class="fa fa-search"></i>
                </button>
                <!-- currency conversion toggle -->
        
                <a id="currency" href="#" class="toggle toggle--usd"></a>
        
                <!-- user icon -->
                
                <div id="imC" class="ContactUs">
                  <img
                  id="user-icon"
            
                  src="/images/<%=photo%>"
                  alt="user icon"
               
                />
         
              </div>
            </div>
          </nav>

      <nav class="navbar">
        <ul class="navbar-nav">
          <li class="logo">
            <a href="/home" class="nav-link">
              <span class="link-text logo-text">PlayStore</span>
              <svg
                aria-hidden="true"
                focusable="false"
                data-prefix="fad"
                data-icon="angle-double-right"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 448 512"
                class="svg-inline--fa fa-angle-double-right fa-w-14 fa-5x"
              >
                <g class="fa-group">
                  <path
                    fill="currentColor"
                    d="M224 273L88.37 409a23.78 23.78 0 0 1-33.8 0L32 386.36a23.94 23.94 0 0 1 0-33.89l96.13-96.37L32 159.73a23.94 23.94 0 0 1 0-33.89l22.44-22.79a23.78 23.78 0 0 1 33.8 0L223.88 239a23.94 23.94 0 0 1 .1 34z"
                    class="fa-secondary"
                  ></path>
                  <path
                    fill="currentColor"
                    d="M415.89 273L280.34 409a23.77 23.77 0 0 1-33.79 0L224 386.26a23.94 23.94 0 0 1 0-33.89L320.11 256l-96-96.47a23.94 23.94 0 0 1 0-33.89l22.52-22.59a23.77 23.77 0 0 1 33.79 0L416 239a24 24 0 0 1-.11 34z"
                    class="fa-primary"
                  ></path>
                </g>
              </svg>
            </a>
          </li>
    
          <li class="nav-item">
            <a href="#" class="nav-link">
              <svg
                aria-hidden="true"
                focusable="false"
                data-prefix="fad"
                data-icon="cat"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512"
                class="svg-inline--fa fa-cat fa-w-16 fa-9x"
              >
                <g class="fa-group">
                  <i
                    class="fa fa-star fa-primary fa-secondary fa-2x icons"
                    id="staricon"
                  ></i>
                </g>
              </svg>
              <span class="link-text">Applications</span>
            </a>
          </li>
    
          <li class="nav-item">
            <a href="#" class="nav-link">
              <svg
                aria-hidden="true"
                focusable="false"
                data-prefix="fad"
                data-icon="gamepad"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 576 512"
                class="svg-inline--fa fa-gamepad fa-w-18 fa-9x"
              >
                <g class="fa-group">
                  <i class="fa fa-gamepad fa-primary fa-secondary fa-2x icons"></i>
                </g>
              </svg>
    
              <span class="link-text">Games</span>
            </a>
          </li>
    
          <li class="nav-item">
            <a href="#" class="nav-link">
              <svg
                aria-hidden="true"
                focusable="false"
                data-prefix="fad"
                data-icon="space-station-moon-alt"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512"
                class="svg-inline--fa fa-space-station-moon-alt fa-w-16 fa-5x"
              >
                <g class="fa-group">
                  <i
                    class="fa fa-play-circle fa-primary fa-secondary fa-2x icons"
                    id="movieicon"
                  ></i>
                </g>
              </svg>
              <span class="link-text">Movies</span>
            </a>
          </li>
    
          <li class="nav-item">
            <a href="#" class="nav-link">
              <svg
                aria-hidden="true"
                focusable="false"
                data-prefix="fad"
                data-icon="space-shuttle"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 640 512"
                class="svg-inline--fa fa-space-shuttle fa-w-20 fa-5x"
              >
                <g class="fa-group">
                  <i class="fa fa-book fa-primary fa-secondary fa-2x icons"></i>
                </g>
              </svg>
              <span class="link-text">Books</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" id="logout-anchor" style="text-decoration: none;">
              <svg
                aria-hidden="true"
                focusable="false"
                data-prefix="fad"
                data-icon="space-shuttle"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 640 512"
                class="svg-inline--fa fa-space-shuttle fa-w-20 fa-5x"
              >
                <g class="fa-group">
                  <i class="fa fa-sign-out-alt fa-primary fa-secondary fa-2x icons"></i>
                </g>
              </svg>
              <form action="/logout?_method=DELETE" method="POST">
              <button type="submit" id="logout-button"><span class="link-text">Logout</span></button>
            </form>
            </a>
          </li>
        </ul>
      </nav>
    
            
            


            
            <script>
                var id = <%=data.id%>;
                var name = "<%=data.name%>";
                var movieName = "<%=data.movieName%>";
                var category = "<%=data.category%>";
                var releaseDate = "<%=data.releaseDate%>";
                var duration = "<%=data.duration%>";
                var rating = <%=data.rating%>;
                var numberOfRatings = <%=data.numberOfRatings%>;
                var price = <%=data.price%>;
                var description = "<%=data.description%>";
                var actors = "<%=data.actors%>";
                var producers = "<%=data.producers%>";
                var writers = "<%=data.writers%>";
                var director = "<%=data.director%>";



                var showingMore = false;
                var isWritingReview = false;
            
            </script>

            <script>
              const themeMap = {
                dark: "light",
                light: "solar",
                solar: "dark"
              };
              
              const theme = localStorage.getItem('theme')
                || (tmp = Object.keys(themeMap)[0],
                    localStorage.setItem('theme', tmp),
                    tmp);
              const bodyClass = document.body.classList;
              bodyClass.add(theme);
              
              function toggleTheme() {
                const current = localStorage.getItem('theme');
                const next = themeMap[current];
              
                bodyClass.replace(current, next);
                localStorage.setItem('theme', next);
              }
              
              //document.getElementById('themeButton').onclick = toggleTheme;

              
            
            </script>

            


        <br><br>
        <br>
        <br>

        
        <div id="bodyContent">
        
        <table id="displayTable">
            <tr>
               
    
              <td>
                <div class="imageView">
                      <img class='imageView' src="/images/<%=data.path%>" style="width:100%">
                </div>
              </td>
                
              <td>
                <br>

                <h1 id="title"></h1>
                <h3 id="drama">  </h3>
                <p id="yearAndDuration"></p>
                <!-- <p id="description"></p> -->
                  <!-- <button id='showMore'> Show More </button> -->

                <% for (var i = 0; i < Math.round(data.averageRating); i++) { %>
                    <span id=star".$i." class='fa fa-star checked'></span>
                <%}%>

                <% for (var i = 0; i < 5 - Math.round(data.averageRating); i++) { %>
                    <span id=star".$j." class='fa fa-star'></span>
                <%}%>

                  <span id="numberOfRatings"></span>



                  
              </td>
          </tr>
          <tr>
            <td>
              <div id=buyOrAddButtons">
                <button id="price" class="buyOrAddToWishList"> Buy Now </button>
                <button class="buyOrAddToWishList"> + Add to wishlist</button>
              </div>
              </td>
          </tr>

            </table>
            <table>
            <tr>
                    <br>
                    <iframe src="https://www.youtube.com/embed/<%=data.trailerID%>"></iframe>
            </tr>

            <tr>
              <td>
                <p id="description"></p>
              </td>
            </tr>
        </table>



        <h3 id="castAndCreditsTitle"> CAST AND CREDITS </h3>
        <br>
        <br>


        <table id="castAndCreditsTable">
            <tr>
              <td id="actorsTitle"> Actors </td>
              <td id="producersTitle"> Producers </td>
            </tr>
            <br>
            <tr>
              <td id="actors"></td>

              <td id="producers"></td>
            </tr>

            
            <tr>
              <td id="writersTitle"> <br> Writers </td>
              <td id="directorTitle"> <br> Director </td>
            </tr>

            <tr>
              <td id="writers"></td>
              <td id="director"><td>

            </tr>
        </table>
        


        <table id="commentsSection">
                <h1> Reviews </h1>
                
                <div id="writeReview">

                    <div class="chat" id="reviewButton">
                          <svg id="chat-bubble" width="80" height="80" viewBox="0 0 100 100">
                            <g class="bubble">
                              <path class="line line1" d="M 30.7873,85.113394 30.7873,46.556405 C 30.7873,41.101961
                              36.826342,35.342 40.898074,35.342 H 59.113981 C 63.73287,35.342
                              69.29995,40.103201 69.29995,46.784744" />
                              <path class="line line2" d="M 13.461999,65.039335 H 58.028684 C
                                63.483128,65.039335
                                69.243089,59.000293 69.243089,54.928561 V 45.605853 C
                                69.243089,40.986964 65.02087,35.419884 58.339327,35.419884" />
                            </g>
                            <circle class="circle circle1" r="1.9" cy="50.7" cx="42.5" />
                            <circle class="circle circle2" cx="49.9" cy="50.7" r="1.9" />
                            <circle class="circle circle3" r="1.9" cy="50.7" cx="57.3" />
                          </svg>
                </div>
            
            <tr> 

              <br>
                <div id='ratings'>
                  <span class="heading">User Ratings</span>
            



            

                <% for (var i = 0; i < Math.round(data.averageRating); i++) { %>
                    <span id=star".$i." class='fa fa-star checked'></span>
                <%}%>

                <% for (var i = 0; i < 5 - Math.round(data.averageRating); i++) { %>
                    <span id=star".$j." class='fa fa-star'></span>
                <%}%>

                <p> <%=data.averageRating%> average based on <%=data.numberOfRatings%> reviews. </p>
                <script>
                    var oneStarPercentage = <%=data.oneStarPercentage%>;
                    var twoStarPercentage = <%=data.twoStarPercentage%>;
                    var threeStarPercentage = <%=data.threeStarPercentage%>;
                    var fourStarPercentage = <%=data.fourStarPercentage%>;
                    var fiveStarPercentage = <%=data.fiveStarPercentage%>;
                </script>
            
                        <hr style="border:3px solid #BBBBBB">
                        
                        <div class="row">
                          <div class="side">
                            <div>5 star</div>
                          </div>
                          <div class="middle">
                            <div class="bar-container">
                              <div id="bar-5"></div>
                            </div>
                          </div>
                          <div class="side right">
                            <div> <%=data.fiveStar%> </div>
                          </div>
                          <div class="side">
                            <div>4 star</div>
                          </div>
                          <div class="middle">
                            <div class="bar-container">
                              <div id="bar-4"></div>
                            </div>
                          </div>
                          <div class="side right">
                            <div> <%=data.fourStar%> </div>
                          </div>
                          <div class="side">
                            <div>3 star</div>
                          </div>
                          <div class="middle">
                            <div class="bar-container">
                              <div id="bar-3"></div>
                            </div>
                          </div>
                          <div class="side right">
                            <div> <%=data.threeStar%> </div>
                          </div>
                          <div class="side">
                            <div>2 star</div>
                          </div>
                          <div class="middle">
                            <div class="bar-container">
                              <div id="bar-2"></div>
                            </div>
                          </div>
                          <div class="side right">
                            <div> <%=data.twoStar%> </div>
                          </div>
                          <div class="side">
                            <div>1 star</div>
                          </div>
                          <div class="middle">
                            <div class="bar-container">
                              <div id="bar-1"></div>
                            </div>
                          </div>
                          <div class="side right">
                            <div> <%=data.oneStar%> </div>
                          </div>
                        </div>
                    </div>

            </tr>
            
                <tr>
                    <br>
                    
                        <td colspan='2'>
                            
                            <div id="nameAndRating">
                                <label for="name">Name:</label>
                                <input type="text" id="name" name="name">

                                <div class="rate">
                                    <input type="radio" id="star5" name="rate" value="5" />
                                    <label for="star5" title="text">5 stars</label>
                                    <input type="radio" id="star4" name="rate" value="4" />
                                    <label for="star4" title="text">4 stars</label>
                                    <input type="radio" id="star3" name="rate" value="3" />
                                    <label for="star3" title="text">3 stars</label>
                                    <input type="radio" id="star2" name="rate" value="2" />
                                    <label for="star2" title="text">2 stars</label>
                                    <input type="radio" id="star1" name="rate" value="1" />
                                    <label for="star1" title="text">1 star</label>
                                  </div>
                            </div>

                        
                            <br>
                            <textarea id="commentTextArea" name="w3review" rows="5"></textarea>
                        </td>
                        
                    
                </tr>
                           
                                            
                                            
                        
                    
            </div>

            <% for (var i = 0; i < data.idArray.length; i++) { %>
                <tr class='commentsRow'>
                   <td> 
                      <div style='width: 100%;'>
                      <div class='image'>
                      <img id='reviewers' src='/comments/<%=data.reviewersArray[i]%>.jpg' width='80' height='80'> 
                      
                      </td>
                <td>
                   <div class='comment'>
                   <h4> <%=data.reviewersArray[i]%> </h4> 


                    
                  <% for (var j = 0; j < data.ratingArray[i]; j++) {%>
                    <span class="fa fa-star checked"></span>
                  <%}%>

                  <% for (var j = 0; j < 5 - data.ratingArray[i]; j++) {%>
                    <span class="fa fa-star"></span>
                  <%}%>


                  <form id="likesForm" action="/like" method="post">
                    <p> <%=data.reviewsArray[i]%> </p> 
                    <i id="thumbsUpButton" class="fa fa-thumbs-up" style="float: right;"><%=data.numberOfLikesArray[i]%></i>
                    <input type="hidden" id="likes" name="NumberOfLikes" value=""/>
                    <input type="hidden" class="nameLikes" name="nameLikes" value=""/>
                  </form>

                  <form id="reportsForm" action="/report" method="post">
                    <button id="reportsButton" class="reportsButtonClass">Report</button>
                    <label id="reportsLbl" class="reportsLblClass"> <%=data.numberOfReportsArray[i]%> </label>
                    <input type="hidden" class="reports" name="NumberOfReports" value=""/>
                    <input type="hidden" class="nameReports" name="nameReports" value=""/>

                  </form>

                  <input type="hidden" class="reviewerNameReports" name="reviewerNameReports" value="<%=data.reviewersArray[i]%>"/> 

                </div> </div>
                </div> </td> 
                </tr>
                
            <%}%>            
        </table>
      </div>
        
    </body>
 
    <head>
    <script>
        
           
            
            document.getElementById('bar-1').style.width = oneStarPercentage + "%";
            document.getElementById('bar-2').style.width = twoStarPercentage + "%";
            document.getElementById('bar-3').style.width = threeStarPercentage + "%";
            document.getElementById('bar-4').style.width = fourStarPercentage + "%";
            document.getElementById('bar-5').style.width = fiveStarPercentage + "%";

            console.log(movieName);
            
          document.getElementById('title').innerHTML = movieName;
          document.getElementById('drama').innerHTML = category;
          document.getElementById('yearAndDuration').innerHTML = releaseDate + "&nbsp&nbsp&nbsp" + duration;
          document.getElementById('numberOfRatings').innerHTML = numberOfRatings;
          document.getElementById('description').innerHTML = description;

          document.getElementById('price').innerHTML += price + "$";
          document.getElementById('actors').innerHTML = actors;
          document.getElementById('producers').innerHTML = producers;
          document.getElementById('writers').innerHTML = writers;
          document.getElementById('director').innerHTML = director;

          


          var likesButton = document.getElementsByClassName("fa fa-thumbs-up");
          var namesHidden = document.getElementsByClassName("reviewerNameReports");
          for (let i = 0; i < likesButton.length; i++) {
            likesButton[i].addEventListener('click', function() {
              // document.getElementsByClassName("nameLikes")[i].value = namesHidden[i].value;
              // console.log(document.getElementsByClassName("nameLikes")[i].value);
              if (likesButton[i].style.color == "") {
                likesButton[i].style.color = "lightblue";
                likesButton[i].innerHTML = parseInt(likesButton[i].innerHTML) + 1;
                document.getElementById("likes").value = parseInt(likesButton[i].innerHTML);
                document.getElementById("likesForm").submit();


              }
              else {
                likesButton[i].style.color = "";
                likesButton[i].innerHTML = parseInt(likesButton[i].innerHTML) - 1;
                document.getElementById("likes").value = parseInt(likesButton[i].innerHTML);
                document.getElementById("likesForm").submit();

              }
            });
          }

          
          var reportsButton = document.getElementsByClassName("reportsButtonClass");
          var reportsLbl = document.getElementsByClassName("reportsLblClass");
          var reportsHidden = document.getElementsByClassName("reports");

            console.log("NO");
            console.log(reportsButton[0].style.backgroundColor);
            // reportsButton[0].style.backgroundColor = "red";

            for (let i = 0; i < reportsLbl.length; i++) {
              reportsButton[i].addEventListener('click', function() {

                if (reportsButton[i].style.backgroundColor == "") {
                  reportsLbl[i].innerHTML = parseInt(reportsLbl[i].innerHTML) + 1;
                  reportsHidden[i].value = parseInt(reportsLbl[i].innerHTML);
                  reportsButton[i].style.backgroundColor = "red";
                  document.getElementById("reportsForm").submit();
                }

                else {
                  reportsLbl[i].innerHTML = parseInt(reportsLbl[i].innerHTML) - 1;
                  reportsHidden[i].value = parseInt(reportsLbl[i].innerHTML);
                  reportsButton[i].style.backgroundColor = "blue";
                  document.getElementById("reportsForm").submit();
                }
              });
              
            }

  



    document.getElementById('reviewButton').addEventListener('click', function() {
        this.classList.toggle('active');
        if (!isWritingReview) {
            document.getElementById('commentTextArea').style.display = "inline";
            document.getElementById('nameAndRating').style.display = "inline";
            document.getElementById('chat-bubble').style.backgroundColor = "red";

            isWritingReview = !isWritingReview
        }
        
        else {
            document.getElementById('commentTextArea').style.display = "none";
            document.getElementById('nameAndRating').style.display = "none";
            document.getElementById('chat-bubble').style.backgroundColor = " rgba(255, 255, 255, 0)";

            isWritingReview = !isWritingReview

        }

    });



    </script>

 <script src="/home.js"></script>
        
    </head>
 
 
 
    </html>

 
